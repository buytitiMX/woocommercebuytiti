document.addEventListener("DOMContentLoaded",(t=>{document.querySelectorAll(".product-item button").forEach((t=>{t.addEventListener("click",(async t=>{const e=t.target.closest(".product-item"),r=e.getAttribute("data-product-id"),a=e.querySelector('input[type="number"]'),o=a?parseInt(a.value,10):1;try{const t=await fetch(`http://localhost/wordpress/wp-json/wc/store/products/${r}`),e=await t.json();if(o>e.add_to_cart.maximum)throw new Error(`X Error: Este artículo solo tiene ${e.add_to_cart.maximum} unidades en stock`);const a=await fetch(`/wordpress/carrito/?add-to-cart=${r}&quantity=${o}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("ck_ff9474de189b37a7aa63b4a9ea3279c5685d3749:cs_aaab9f6527fdc3f132bdb2c10516d08e1c4222bd")},body:JSON.stringify({product_id:r,quantity:o})});if(!a.ok)throw new Error(`X Error al añadir el producto al carrito: ${a.statusText}`);const c=document.getElementById("success-alert");c.textContent="✓ Se añadió tu producto al carrito correctamente",c.style.display="flex",c.style.height="2.5rem",c.style.alignItems="center",c.style.paddingLeft="1rem",setTimeout((()=>{c.style.display="none"}),4e3),console.log(`Producto agregado al carrito: ${r}`)}catch(t){console.error("Error al añadir el producto al carrito:",t.message);const e=document.getElementById("error-alert");e.textContent=t.message,e.style.display="flex",e.style.height="2.5rem",e.style.alignItems="center",e.style.paddingLeft="1rem",setTimeout((()=>{e.style.display="none"}),4e3)}}))})),document.querySelectorAll('.product-item input[type="number"]').forEach((t=>{t.addEventListener("input",(t=>{const e=parseInt(t.target.getAttribute("data-max"),10);t.target.value>e&&(t.target.value=e)}))}))}));